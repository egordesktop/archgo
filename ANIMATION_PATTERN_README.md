# Универсальный паттерн управления анимациями

## Описание

Данный паттерн обеспечивает предотвращение повторного запуска или выключения анимаций при повторном клике на кнопки, запускающие анимации.

## Принцип работы

### 1. Отдельные переменные состояния для каждой анимации

Каждая анимация имеет свою переменную состояния:
- `isMonthAnimating` - анимация перелистывания месяцев
- `isTodayAnimating` - анимация выделения сегодняшней даты
- `isModalOpen` - анимация открытия/закрытия модального окна

### 2. Логика обработчиков

Для каждой кнопки, запускающей анимацию, используется одинаковая логика:

```jsx
const handleAnimationClick = () => {
  // Если соответствующая анимация уже активна, не делаем ничего
  if (isAnimationActive) {
    return;
  }
  
  // Запускаем анимацию
  setIsAnimationActive(true);
  // ... логика анимации
};
```

### 3. Отключение анимаций

Анимации отключаются только через логику "отмены":
- Клик вне области анимации
- Программное отключение (например, при смене месяца)
- Автоматическое завершение анимации

## Реализованные анимации

### 1. Анимация перелистывания месяцев (`changeMonth`)

**Переменная состояния:** `isMonthAnimating`

**Логика:**
- Если анимация уже активна → клик игнорируется
- Если анимация неактивна → запускается анимация перехода
- Анимация автоматически завершается через 300ms

**Кнопки:** Левая и правая стрелки навигации

### 2. Анимация выделения сегодняшней даты (`goToToday`)

**Переменная состояния:** `isTodayAnimating`

**Логика:**
- Если анимация уже активна → клик игнорируется
- Если анимация неактивна → запускается анимация выделения
- Анимация отключается при клике вне области или смене месяца

**Кнопка:** Иконка календаря (FiCalendar)

### 3. Анимация модального окна

**Переменная состояния:** `isModalOpen`

**Логика:**
- Управляется через `isOpen` пропс
- Открытие/закрытие через `onClose` callback
- Анимация через Framer Motion

## Преимущества паттерна

1. **Предотвращение конфликтов** - повторные клики не мешают текущим анимациям
2. **Улучшенный UX** - пользователь не может случайно прервать анимацию
3. **Консистентность** - все анимации работают одинаково
4. **Простота поддержки** - единый подход для всех анимаций

## Добавление новых анимаций

Для добавления новой анимации:

1. Создайте переменную состояния: `const [isNewAnimationActive, setIsNewAnimationActive] = useState(false);`

2. Добавьте проверку в обработчик:
```jsx
const handleNewAnimation = () => {
  if (isNewAnimationActive) {
    return;
  }
  setIsNewAnimationActive(true);
  // ... логика анимации
};
```

3. Добавьте логику отключения анимации в соответствующих местах

## Примеры использования

### Кнопка календаря (сегодняшняя дата)
```jsx
const goToToday = () => {
  if (isTodayAnimating) {
    return;
  }
  // ... запуск анимации
};
```

### Кнопка перелистывания месяцев
```jsx
const changeMonth = (dir) => {
  if (isMonthAnimating) {
    return;
  }
  // ... запуск анимации
};
```

## Важные моменты

- Внешний вид и функционал сайта остаются полностью неизменными
- Анимации управляются только состоянием и "гаснут" при клике вне области
- Повторный клик на любую кнопку не отключает и не перезапускает анимацию
- Все кнопки, запускающие разные анимации, работают одинаково
